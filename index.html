<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>WorldEdit Documentation</title>
  <meta name="generator" content="Bootply" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!--[if lt IE 9]>
  <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Roboto:700' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>
  <link href="css/styles.css" rel="stylesheet">
</head>
<body>

<div id="masthead">
  <div class="container">
    <div class="row">
      <div class="col-md-7 col-md-offset-3">
        <img src="./img/logo2.png">
        <h2>An architectural approach</h2>
        <small>
          <a href="https://github.com/joaolrpaulo/">Pedro Lourenço</a>,
          <a href="https://github.com/pedroo21">João Paulo</a>,
          <a href="https://github.com/marcopontes">Marco Pontes</a> e Andreia Costa
        </small>
        <p class="small">May 28, 2016</p>
      </div>
    </div>
  </div><!--/container-->
</div><!--/masthead-->

<!--main-->
<div class="container-fluid">
  <div class="row">
    <!--left-->
    <div class="col-md-3" id="leftCol">
      <img src="http://www.idpasc.lip.pt/LIP/events/2015_workshop_foundations/images/logo_FCUP.jpg"
           class="img-responsive img-thumbnail">

      <ul class="nav nav" id="sidebar">
        <li class="tree">
          <a class="tree-toggle" href="#">Introduction <span class="caret"></span></a>
          <ul class="nav tree">
            <li><a href="#sec0">User View</a></li>
            <li><a href="#sec1">Developer View</a></li>
          </ul>
        </li>
        <li class="tree">
          <a class="tree-toggle" href="#">Features <span class="caret"></span></a>
          <ul class="nav tree">
            <li><a href="#sec2">Region Operations</a></li>
            <li><a href="#sec3">Clipboard</a></li>
            <li><a href="#sec4">Generation</a></li>
            <li><a href="#sec5">Utility</a></li>
          </ul>
        </li>
        <li class="tree">
          <a class="tree-toggle" href="#">Stakeholders <span class="caret"></span></a>
          <ul class="nav tree">
            <li><a href="#sec6">Developers</a></li>
            <li><a href="#sec7">Users</a></li>
          </ul>
        </li>
        <li class="tree">
          <a class="tree-toggle" href="#">Architecture <span class="caret"></span></a>
          <ul class="nav tree">
            <li><a href="#sec8">Logical View</a></li>
            <li><a href="#sec9">Development View</a></li>
            <li><a href="#sec10">Process View</a></li>
            <li><a href="#sec11">Physical View</a></li>
            <li><a href="#sec12">Scenarios</a></li>
          </ul>
        </li>
        <li><a href="#sec13">Improving WorldEdit</a></li>
        <li><a href="#sec14">Conclusion</a></li>
        <li><a href="#sec15">Bibliography</a></li>
      </ul>
    </div><!--/left-->

    <!--right-->
    <div class="col-md-9 col-md-offset-3">
      <h1>Introduction</h1>
      <hr>
      <p>This project is for a college subject (Software Arquitecture), and we want achieve some goals like:</p>
        <p>We want to focus on the mechanical part of this project.</p>


      <h2 id="sec0">User View</h2>
      <hr>
      <h3>World Edit, What is it?</h3>
      <hr>
      <p>
        WorldEdit is a worldwide known framework for Minecraft, between many features, it holds some interesting ones:
      <ul>
        <li>Select a region of a map (like pinpoint two positions in map)</li>
        <li>Fix map problems, such as broken water, missing snow, broken walls and much more!</li>
        <li>Make big constructions with two clicks</li>
        <li>Change blocks from one type to another, like from grass to diamond</li>
        <li>Create objects with one click, e.g, trees, spheres, animals</li>
      </ul>


      <h2 id="sec1">Developer View</h2>
      <hr>
      <p>Include here chunk explanation.</p>



      <h2>Features <small>Very summarized overview with main functions</small></h2>
      <hr>
      <p>We will omit most command sintaxe. However, a detailed overview of all commands
        can be found in the <a href="http://wiki.sk89q.com/wiki/WorldEdit">official documentation</a>.</p>


      <h3 id="sec2">Region Operations</h3>
      <hr>
      <p>It's possible to perform a long range of region operations with World Edit.</p>
      <p>To perform those kind of operations, the user is required to select a Cuboid area. This is done by selecting
      two points which will create a rectangular selecion (other shapes and formats can also be used).</p>
      <p>Using the selected area, we can perform changes like:</p>
      <ul>
        <li>Setting Blocks</li>
        <li>Replacing Blocks (example below)</li>
        <li>Create walls</li>
        <li>Place overlays over a range of blocks</li>
        <li>Stacking (example below)</li>
        <li>Move a set of blocks</li>
        <li>Smooth an area, for example, a rough mountain</li>
        <li>Naturalize, make an area look more natural with grass and dirt</li>
        <li>Placing flora, scatter tall grass and flowers for grass or cactus for sand</li>
        <li>Deform regions, applying a user defined equation</li>
      </ul>
      <div class="blockquote-box blockquote-primary">
        <h4>
          Region Selecion</h4>
        <p>
          Usage: //wand <small>[Gives user an item that can be used to flag first position (left click) and second position (right click)]</small>
        </p><p>Usage: //pos1 or //pos2 <small>[Selects first and second positions]</small>
      </p>
      </div>
      <img src="img/ingame/cuboid.png">

      <br><br>
      <p>Some examples of region operations are:</p>
      <div class="row">
        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3>Setting/Replacing Blocks</h3>
              <small>//replace [list-of-blocks-to-replace] [block-to-replace-with]</small>
            </div>
            <div class="panel-body">
              <a class="fancybox" rel="group" href="img/ingame/replaceblocks.png">
                <img width="418" height="350" src="img/ingame/replaceblocks.png">
              </a>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3>Stacking</h3>
              <small>//stack [count] [direction]</small>
            </div>
            <div class="panel-body">
              <a class="fancybox" rel="group" href="img/ingame/stacking.jpg">
                <img width="418" height="350" src="img/ingame/stacking.jpg">
              </a>
            </div>
          </div>
        </div>
      </div>


      <h3 id="sec3">Clipboard</h3>
      <hr>
      <p>Some examples of clipboard operations are:</p>
      <div class="row">
        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3>Copy/Paste Areas</h3>
              <small>//copy //paste [-aso]</small>
            </div>
            <div class="panel-body">
              <a class="fancybox" rel="group" href="img/ingame/copypaste.png">
                <img width="418" height="350" src="img/ingame/copypaste.png">
              </a>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading"><h3>Stacking</h3></div>
            <div class="panel-body">
              <a class="fancybox" rel="group" href="img/ingame/stacking.jpg">
                <img width="418" height="350" src="img/ingame/stacking.jpg">
              </a>
            </div>
          </div>
        </div>
      </div>


      <h3 id="sec4">Generation</h3>
      <hr>


      <h3 id="sec5">Utility</h3>
      <hr>



      <h2>Stakeholders</h2>
      <hr>
      <p>Text</p>


      <h3 id="sec6">Developers</h3>
      <hr>
      <div class="row no-gutter">
        <div class="col-md-6">
          <img class="img-responsive" src="img/ingame/contributor1.png">
        </div>
        <div class="col-md-6">
          <img class="img-responsive" src="img/ingame/contributor2.png">
        </div>
      </div>
      <div class="row no-gutter">
        <div class="col-md-6">
          <img class="img-responsive" src="img/ingame/contributor3.png">
        </div>
        <div class="col-md-6">
          <img class="img-responsive" src="img/ingame/contributor4.png">
        </div>
      </div>


      <h3 id="sec7">Users</h3>
      <hr>
      <p>Text</p>



      <h2>Architecture</h2>
      <hr>
      <p>
        At this diagram we tried to only represent the important classes among all the project as this is a
        huge project, the full class diagram wouldn't be user-friendly.
        We tried to put all important related classes at a bucket so it will be more easy to look
        at and explain whats happeninng.</p>
      <p>Basically this project has three big packages (or Schemas):</p>

      <ul>
        <li><a href="https://github.com/joaolrpaulo/WorldEdit/tree/introduction/worldedit-core">WorldEdit-Core
          </a>, this is the main project. It’s independent from any adapter.</li>
        <li><a href="https://github.com/joaolrpaulo/WorldEdit/tree/introduction/worldedit-bukkit">WorldEdit-Bukkit
          </a>, the adapter redirected to the Bukkit platform.</li>
        <li><a href="https://github.com/joaolrpaulo/WorldEdit/tree/introduction/worldedit-forge">WorldEdit-Forge
        </a>, the adapter redirected to the Forge platform.</li>
      </ul>

      <p>As for these last two, they are needed to support multiple plugins on Minecraft,
        responsible for loading all the required plugins and create the server-type environment.
        All the classes that we didn't represent here, are the ones that we didn't consider as
        fundamental for the analysis.</p>


      <h3 id="sec8">Logical View</h3>
      <hr>


      <h3 id="sec9">Development View</h3>
      <hr>
      <div class="container-corners">
        <a class="fancybox" rel="group" href="img/Development%20View.png">
         <img class="img-responsive" src="img/Development%20View.png">
        </a>
      </div>


      <h3 id="sec10">Process View</h3>
      <hr>
      <div class="container-corners">
        <a class="fancybox" rel="group" href="img/Activity%20View.png">
          <img class="img-responsive margin-corners" src="img/Activity%20View.png">
        </a>
      </div>


      <h3 id="sec11">Physical View</h3>
      <hr>
      <div class="container-corners">
        <a class="fancybox" rel="group" href="img/Development%20View.png">
          <img class="img-responsive" src="img/Development%20View.png">
        </a>
      </div>


      <h3 id="sec12">Scenarios</h3>
      <hr>
      <div class="container-corners">
        <a class="fancybox" rel="group" href="img/Use%20Cases.png">
          <div class="col-md-12" align="center"><img src="img/Use%20Cases.png"></div>
        </a>
      </div>



      <h2>Storage</h2>
      <hr>
      <h3>YAML</h3>
      <hr>
      <p>YAML is a encoding format that makes data more readable by human beings,
        it was inspired in languages suchs as XML, Python, Perl, and Internet Message Protocol.
        It was created by Clark Evans, Brian Ingerson and Oren Ben-Kiki, by the year of 2000.</p>
      <p>YAML (pronounced as "yammel"), was designed with a very proper idea,
        that every data could be represented by a set of list, hashes, and simple values.
        YAML only uses unicode characters (UTF-8 and UTF-16).YAML is relatively simple to use.
        The respective file holds the information in a
        indented format like the example below:</p>
      <pre>
        Blocks:
        - Grass
        - Sand
        - Stone

        Users:
          Pedro: '- Developer'
          Marco: '* Second Developer'
          João: '# Developer'
          Andreia: '\ Developer'</pre>
      <p>Within the domain of the Java language, YAML fields can be easily accessed using:</p>
      <code style=display:block;white-space:pre-wrap>
        yamlFile.getStringList("Blocks");
        // Will return a list ['Grass', 'Sand', 'Stone']
      </code>
      <code style=display:block;white-space:pre-wrap>
        yamlFile.getConfigurationSection('Users').getKeys(false)
        // Will return ['Pedro', 'Marco', 'Joao', 'Andreia']
        // We can now do:

        yamlFile.getString("Users.Pedro");
        // Will return '- Developer'
      </code>
      <p></p>
      <p>In the context of the project that we have been reviewing during this semester,
        YAML is used to store some configurations related to multiple aspects such as:</p>
      <ul>
        <li>User data</li>
        <li>World data</li>
        <li>Blocks data</li>
        <li>Command restrictions</li>
        <li>Zone restrictions, among others.</li>
      </ul>
      An more particular example can be found at <a href="https://github.com/sk89q/WorldEdit/blob/master/
      worldedit-bukkit/src/main/resources/defaults/config.yml">config.yml</a>.



      <h2 id="sec13">Improving WorldEdit</h2>
      <hr>
      <h3>The Problem</h3>
      <hr>
      <p>Minecraft, more specific, the Bukkit Adapter has known limitations related to asynchronous world modification.
        If we try to run block modifications in a separate thread we will get an exception like:</p>

      <blockquote style=display:block;white-space:pre-wrap>[Timer-51/WARN]: java.lang.IllegalStateException: Asynchronous block remove!</blockquote>

      <p>Derived from this, World Edit core runs every task using the main thread.
        This decision can cause complications when performing tasks with a massive number of blocks.
        As for example, if we try to paste a schematic with 1 million blocks running World Edit in a server
        with the following specifications:</p>

      <blockquote style=display:block;white-space:pre-wrap>
        Intel Xeon E3 1225v2 3.2 GHz+

        4GB of RAM allocated to the server
      </blockquote>

      <p>The server will stop responding after a few seconds, possibly causing world chunk errors.</p>

      <h3>The Solution</h3>
      <hr>
      <p>
        After studying the problem, it's possible to understand we can archieve an asynchronous operation
        and still avoid to use a separate thread. We can do this by scheduling the number of blocks per a unit of time.
        Let's take again our example of 1 million blocks. If we define a static constant of <strong>5000 blocks
        per each second</strong>, we can schedule consecutive tasks and complete our task in about 3.33 minutes.</p>

       <pre>
         <strong>Task #1</strong>
         Modify 5000 blocks
         Run now

         <strong>Task #2</strong>
         Modify 5000 blocks
         Run after 1 second

         <strong>Task #3</strong>
         Modify 5000 blocks
         Run after 2 seconds</pre>
      <p>

      <p>After 200 tasks, we will complete our job. This method will give us the ability to see the progress
      of our operation and avoid any world/chunk errors if the server gets shutdown. The job can be saved to
      the disk and sustained any time.</p>



      <h2 id="sec14">Conclusion</h2>
      <hr>
      <p>Text here</p>



      <h2 id="sec15">Bibliography</h2>
      <hr>
      <p>Text here</p>

    </div><!--/right-->
  </div><!--/row-->
</div><!--/container-->



<!-- script references -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="js/fancybox/source/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="js/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
<script src="js/scripts.js"></script>
</body>
</html>